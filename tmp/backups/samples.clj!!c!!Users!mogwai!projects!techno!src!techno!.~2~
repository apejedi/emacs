(ns techno.samples
  (:use [clojure.java.io]
        [overtone.sc.sample]
        )
  (:require [clojure.string :as string])
  )


(defn create-sample-map [path]
  (let [directory (file path)
        tree (reduce (fn [tree listing]
                       (if (and (.isFile listing) (or (.contains (.getName listing) "wav") (.contains (.getName listing) "aiff")))
                         (let [path
                               (map (fn [part]
                                      (keyword (string/replace (string/replace part " " "") ":" ""))
                                      )
                                    (string/split (.getAbsolutePath listing) #"\\")
                                    )
                               disk-path (string/replace (.getAbsolutePath listing) "\\" "\\\\")
                               ]

                           ;(update-in tree path (fn [_] (sample disk-path)))
                           (assoc tree (keyword (.getName listing)) (sample disk-path))
                           )
                         tree
                         )
                       )
                     {}
                     (file-seq directory)
               )
        ]
    tree
    )
  )


(def)

;; (def sample-test (create-sample-map "D:\\musicradar-drum-samples\\musicradar-drum-samples\\Assorted Hits\\Kicks\\Kes Kick"))

;; (doseq [[_ s] sample-test]
;;   (s)
;;   (java.lang.Thread/sleep 1000)
;;   )
